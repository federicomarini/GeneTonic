<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Alluvial (sankey) plot for a set of genesets and the associated genes — gs_alluvial • GeneTonic</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Alluvial (sankey) plot for a set of genesets and the associated genes — gs_alluvial"><meta property="og:description" content="Generate an interactive alluvial plot linking genesets to their associated
genes"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- dependencies from examples --><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><script src="libs/jquery-3.5.1/jquery.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet"><script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet"><script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GeneTonic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/GeneTonic_manual.html">The `GeneTonic` User's Guide
</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/federicomarini/GeneTonic" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Alluvial (sankey) plot for a set of genesets and the associated genes</h1>
    <small class="dont-index">Source: <a href="https://github.com/federicomarini/GeneTonic/blob/HEAD/R/gs_alluvial.R" class="external-link"><code>R/gs_alluvial.R</code></a></small>
    <div class="hidden name"><code>gs_alluvial.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate an interactive alluvial plot linking genesets to their associated
genes</p>
    </div>

    <div id="ref-usage">Usage,<div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gs_alluvial</span><span class="op">(</span>
  <span class="va">res_enrich</span>,
  <span class="va">res_de</span>,
  <span class="va">annotation_obj</span>,
  gtl <span class="op">=</span> <span class="cn">NULL</span>,
  n_gs <span class="op">=</span> <span class="fl">5</span>,
  gs_ids <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="fu">gs_sankey</span><span class="op">(</span>
  <span class="va">res_enrich</span>,
  <span class="va">res_de</span>,
  <span class="va">annotation_obj</span>,
  gtl <span class="op">=</span> <span class="cn">NULL</span>,
  n_gs <span class="op">=</span> <span class="fl">5</span>,
  gs_ids <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div></div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>res_enrich</dt>
<dd><p>A <code>data.frame</code> object, storing the result of the functional
enrichment analysis. See more in the main function, <code><a href="GeneTonic.html">GeneTonic()</a></code>, to check the
formatting requirements (a minimal set of columns should be present).</p></dd>
<dt>res_de</dt>
<dd><p>A <code>DESeqResults</code> object.</p></dd>
<dt>annotation_obj</dt>
<dd><p>A <code>data.frame</code> object with the feature annotation
information, with at least two columns, <code>gene_id</code> and <code>gene_name</code>.</p></dd>
<dt>gtl</dt>
<dd><p>A <code>GeneTonic</code>-list object, containing in its slots the arguments
specified above: <code>dds</code>, <code>res_de</code>, <code>res_enrich</code>, and <code>annotation_obj</code> - the names
of the list <em>must</em> be specified following the content they are expecting</p></dd>
<dt>n_gs</dt>
<dd><p>Integer value, corresponding to the maximal number of gene sets to
be displayed</p></dd>
<dt>gs_ids</dt>
<dd><p>Character vector, containing a subset of <code>gs_id</code> as they are
available in <code>res_enrich</code>. Lists the gene sets to be displayed.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>plotly</code> object</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"macrophage"</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/mikelove/DESeq2" class="external-link">"DESeq2"</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"org.Hs.eg.db"</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.org/packages/AnnotationDbi" class="external-link">"AnnotationDbi"</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># dds object</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gse"</span>, package <span class="op">=</span> <span class="st">"macrophage"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dds_macrophage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html" class="external-link">DESeqDataSet</a></span><span class="op">(</span><span class="va">gse</span>, design <span class="op">=</span> <span class="op">~</span> <span class="va">line</span> <span class="op">+</span> <span class="va">condition</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> using counts and average transcript lengths from tximeta</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dds_macrophage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dds_macrophage</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dds_macrophage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">estimateSizeFactors</a></span><span class="op">(</span><span class="va">dds_macrophage</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> using 'avgTxLength' from assays(dds), correcting for library size</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># annotation object</span></span>
<span class="r-in"><span class="va">anno_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span class="r-in">  gene_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dds_macrophage</span><span class="op">)</span>,</span>
<span class="r-in">  gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">mapIds</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>,</span>
<span class="r-in">    keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dds_macrophage</span><span class="op">)</span>,</span>
<span class="r-in">    column <span class="op">=</span> <span class="st">"SYMBOL"</span>,</span>
<span class="r-in">    keytype <span class="op">=</span> <span class="st">"ENSEMBL"</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dds_macrophage</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'select()' returned 1:many mapping between keys and columns</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># res object</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">res_de_macrophage</span>, package <span class="op">=</span> <span class="st">"GeneTonic"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res_de</span> <span class="op">&lt;-</span> <span class="va">res_macrophage_IFNg_vs_naive</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># res_enrich object</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">res_enrich_macrophage</span>, package <span class="op">=</span> <span class="st">"GeneTonic"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res_enrich</span> <span class="op">&lt;-</span> <span class="fu"><a href="shake_topGOtableResult.html">shake_topGOtableResult</a></span><span class="op">(</span><span class="va">topgoDE_macrophage_IFNg_vs_naive</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Found 500 gene sets in `topGOtableResult` object.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting for usage in GeneTonic...</span>
<span class="r-in"><span class="va">res_enrich</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_aggrscores.html">get_aggrscores</a></span><span class="op">(</span><span class="va">res_enrich</span>, <span class="va">res_de</span>, <span class="va">anno_df</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">gs_alluvial</span><span class="op">(</span></span>
<span class="r-in">  res_enrich <span class="op">=</span> <span class="va">res_enrich</span>,</span>
<span class="r-in">  res_de <span class="op">=</span> <span class="va">res_de</span>,</span>
<span class="r-in">  annotation_obj <span class="op">=</span> <span class="va">anno_df</span>,</span>
<span class="r-in">  n_gs <span class="op">=</span> <span class="fl">4</span></span>
<span class="r-in"><span class="op">)</span></span>
<div id="htmlwidget-2ef9e8a2a9722488236a" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2ef9e8a2a9722488236a">{"x":{"visdat":{"109a43b231592":["function () ","plotlyVisDat"]},"cur_data":"109a43b231592","attrs":{"109a43b231592":{"domain":{"x":[0,1],"y":[0,1]},"orientation":"h","valueformat":".0f","node":{"label":["adaptive immune response","interferon-gamma-mediated signaling pathway","type I interferon signaling pathway","antigen processing and presentation of endogenous peptide antigen via MHC class I","B2M ","BCL6 ","BTN3A1 ","BTN3A2 ","BTN3A3 ","C1QB ","C1R ","C1RL ","C1S ","C2 ","C3 ","C4A ","C4B ","CD1A ","CD1C ","CD274 ","CD28 ","CD40 ","CD7 ","CD74 ","CD80 ","CEACAM1 ","CLEC10A ","CLEC6A ","CTLA4 ","CTSS ","ERAP2 ","EXO1 ","FGL1 ","FGL2 ","GCNT3 ","GPR183 ","HLA-A ","HLA-B ","HLA-C ","HLA-DMA ","HLA-DMB ","HLA-DOA ","HLA-DOB ","HLA-DPA1 ","HLA-DPB1 ","HLA-DQA1 ","HLA-DQB1 ","HLA-DQB2 ","HLA-DRA ","HLA-DRB1 ","HLA-DRB5 ","HLA-E ","HLA-F ","HLA-G ","ICAM1 ","IL12A ","IL12RB1 ","IL18BP ","IL27 ","IRF1 ","IRF7 ","ITK ","JAK2 ","JAK3 ","KLRK1 ","LAG3 ","LAMP3 ","LILRA1 ","LILRB3 ","LYN ","MCOLN2 ","P2RX7 ","PDCD1 ","PDCD1LG2 ","RELB ","RIPK2 ","RNF19B ","RSAD2 ","SERPING1 ","SIT1 ","SLAMF1 ","SLAMF6 ","SLAMF7 ","SLC11A1 ","TAP1 ","TAP2 ","TBX21 ","TLR8 ","TNFRSF11A ","TNFRSF21 ","TNFSF13B ","TNFSF18 ","ZC3H12A ","CAMK2D ","CIITA ","GBP1 ","GBP2 ","MT2A ","NLRC5 ","NMI ","OAS2 ","PARP14 ","PML ","SOCS1 ","STAT1 ","TRIM22 ","TRIM31 ","VCAM1 ","IFI27 ","IFI35 ","IFIT2 ","IFIT3 ","IFITM1 ","IFITM2 ","IFITM3 ","ISG20 ","PSMB8 ","STAT2 ","XAF1 ","ZBP1 ","TAPBP "],"color":["#440154FF","#31688EFF","#35B779FF","#FDE725FF","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue"],"pad":15,"thickness":20,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3],"target":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,4,93,94,95,96,36,37,38,43,44,45,46,47,48,49,50,51,52,53,54,59,60,62,97,98,99,100,101,102,103,104,105,106,107,96,36,37,38,51,52,53,108,109,110,111,112,113,114,59,60,115,98,100,116,77,104,117,118,119,4,30,36,37,38,51,52,53,84,85,120],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Geneset-Gene Sankey Diagram","font":{"size":10},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"domain":{"x":[0,1],"y":[0,1]},"orientation":"h","valueformat":".0f","node":{"label":["adaptive immune response","interferon-gamma-mediated signaling pathway","type I interferon signaling pathway","antigen processing and presentation of endogenous peptide antigen via MHC class I","B2M ","BCL6 ","BTN3A1 ","BTN3A2 ","BTN3A3 ","C1QB ","C1R ","C1RL ","C1S ","C2 ","C3 ","C4A ","C4B ","CD1A ","CD1C ","CD274 ","CD28 ","CD40 ","CD7 ","CD74 ","CD80 ","CEACAM1 ","CLEC10A ","CLEC6A ","CTLA4 ","CTSS ","ERAP2 ","EXO1 ","FGL1 ","FGL2 ","GCNT3 ","GPR183 ","HLA-A ","HLA-B ","HLA-C ","HLA-DMA ","HLA-DMB ","HLA-DOA ","HLA-DOB ","HLA-DPA1 ","HLA-DPB1 ","HLA-DQA1 ","HLA-DQB1 ","HLA-DQB2 ","HLA-DRA ","HLA-DRB1 ","HLA-DRB5 ","HLA-E ","HLA-F ","HLA-G ","ICAM1 ","IL12A ","IL12RB1 ","IL18BP ","IL27 ","IRF1 ","IRF7 ","ITK ","JAK2 ","JAK3 ","KLRK1 ","LAG3 ","LAMP3 ","LILRA1 ","LILRB3 ","LYN ","MCOLN2 ","P2RX7 ","PDCD1 ","PDCD1LG2 ","RELB ","RIPK2 ","RNF19B ","RSAD2 ","SERPING1 ","SIT1 ","SLAMF1 ","SLAMF6 ","SLAMF7 ","SLC11A1 ","TAP1 ","TAP2 ","TBX21 ","TLR8 ","TNFRSF11A ","TNFRSF21 ","TNFSF13B ","TNFSF18 ","ZC3H12A ","CAMK2D ","CIITA ","GBP1 ","GBP2 ","MT2A ","NLRC5 ","NMI ","OAS2 ","PARP14 ","PML ","SOCS1 ","STAT1 ","TRIM22 ","TRIM31 ","VCAM1 ","IFI27 ","IFI35 ","IFIT2 ","IFIT3 ","IFITM1 ","IFITM2 ","IFITM3 ","ISG20 ","PSMB8 ","STAT2 ","XAF1 ","ZBP1 ","TAPBP "],"color":["#440154FF","#31688EFF","#35B779FF","#FDE725FF","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue"],"pad":15,"thickness":20,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3],"target":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,4,93,94,95,96,36,37,38,43,44,45,46,47,48,49,50,51,52,53,54,59,60,62,97,98,99,100,101,102,103,104,105,106,107,96,36,37,38,51,52,53,108,109,110,111,112,113,114,59,60,115,98,100,116,77,104,117,118,119,4,30,36,37,38,51,52,53,84,85,120],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><span class="r-in"><span class="co"># or using the alias...</span></span>
<span class="r-in"><span class="fu">gs_sankey</span><span class="op">(</span></span>
<span class="r-in">  res_enrich <span class="op">=</span> <span class="va">res_enrich</span>,</span>
<span class="r-in">  res_de <span class="op">=</span> <span class="va">res_de</span>,</span>
<span class="r-in">  annotation_obj <span class="op">=</span> <span class="va">anno_df</span>,</span>
<span class="r-in">  n_gs <span class="op">=</span> <span class="fl">4</span></span>
<span class="r-in"><span class="op">)</span></span>
<div id="htmlwidget-c8e2fa2b0be21dbe137b" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c8e2fa2b0be21dbe137b">{"x":{"visdat":{"109a47c5d4292":["function () ","plotlyVisDat"]},"cur_data":"109a47c5d4292","attrs":{"109a47c5d4292":{"domain":{"x":[0,1],"y":[0,1]},"orientation":"h","valueformat":".0f","node":{"label":["adaptive immune response","interferon-gamma-mediated signaling pathway","type I interferon signaling pathway","antigen processing and presentation of endogenous peptide antigen via MHC class I","B2M ","BCL6 ","BTN3A1 ","BTN3A2 ","BTN3A3 ","C1QB ","C1R ","C1RL ","C1S ","C2 ","C3 ","C4A ","C4B ","CD1A ","CD1C ","CD274 ","CD28 ","CD40 ","CD7 ","CD74 ","CD80 ","CEACAM1 ","CLEC10A ","CLEC6A ","CTLA4 ","CTSS ","ERAP2 ","EXO1 ","FGL1 ","FGL2 ","GCNT3 ","GPR183 ","HLA-A ","HLA-B ","HLA-C ","HLA-DMA ","HLA-DMB ","HLA-DOA ","HLA-DOB ","HLA-DPA1 ","HLA-DPB1 ","HLA-DQA1 ","HLA-DQB1 ","HLA-DQB2 ","HLA-DRA ","HLA-DRB1 ","HLA-DRB5 ","HLA-E ","HLA-F ","HLA-G ","ICAM1 ","IL12A ","IL12RB1 ","IL18BP ","IL27 ","IRF1 ","IRF7 ","ITK ","JAK2 ","JAK3 ","KLRK1 ","LAG3 ","LAMP3 ","LILRA1 ","LILRB3 ","LYN ","MCOLN2 ","P2RX7 ","PDCD1 ","PDCD1LG2 ","RELB ","RIPK2 ","RNF19B ","RSAD2 ","SERPING1 ","SIT1 ","SLAMF1 ","SLAMF6 ","SLAMF7 ","SLC11A1 ","TAP1 ","TAP2 ","TBX21 ","TLR8 ","TNFRSF11A ","TNFRSF21 ","TNFSF13B ","TNFSF18 ","ZC3H12A ","CAMK2D ","CIITA ","GBP1 ","GBP2 ","MT2A ","NLRC5 ","NMI ","OAS2 ","PARP14 ","PML ","SOCS1 ","STAT1 ","TRIM22 ","TRIM31 ","VCAM1 ","IFI27 ","IFI35 ","IFIT2 ","IFIT3 ","IFITM1 ","IFITM2 ","IFITM3 ","ISG20 ","PSMB8 ","STAT2 ","XAF1 ","ZBP1 ","TAPBP "],"color":["#440154FF","#31688EFF","#35B779FF","#FDE725FF","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue"],"pad":15,"thickness":20,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3],"target":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,4,93,94,95,96,36,37,38,43,44,45,46,47,48,49,50,51,52,53,54,59,60,62,97,98,99,100,101,102,103,104,105,106,107,96,36,37,38,51,52,53,108,109,110,111,112,113,114,59,60,115,98,100,116,77,104,117,118,119,4,30,36,37,38,51,52,53,84,85,120],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Geneset-Gene Sankey Diagram","font":{"size":10},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"domain":{"x":[0,1],"y":[0,1]},"orientation":"h","valueformat":".0f","node":{"label":["adaptive immune response","interferon-gamma-mediated signaling pathway","type I interferon signaling pathway","antigen processing and presentation of endogenous peptide antigen via MHC class I","B2M ","BCL6 ","BTN3A1 ","BTN3A2 ","BTN3A3 ","C1QB ","C1R ","C1RL ","C1S ","C2 ","C3 ","C4A ","C4B ","CD1A ","CD1C ","CD274 ","CD28 ","CD40 ","CD7 ","CD74 ","CD80 ","CEACAM1 ","CLEC10A ","CLEC6A ","CTLA4 ","CTSS ","ERAP2 ","EXO1 ","FGL1 ","FGL2 ","GCNT3 ","GPR183 ","HLA-A ","HLA-B ","HLA-C ","HLA-DMA ","HLA-DMB ","HLA-DOA ","HLA-DOB ","HLA-DPA1 ","HLA-DPB1 ","HLA-DQA1 ","HLA-DQB1 ","HLA-DQB2 ","HLA-DRA ","HLA-DRB1 ","HLA-DRB5 ","HLA-E ","HLA-F ","HLA-G ","ICAM1 ","IL12A ","IL12RB1 ","IL18BP ","IL27 ","IRF1 ","IRF7 ","ITK ","JAK2 ","JAK3 ","KLRK1 ","LAG3 ","LAMP3 ","LILRA1 ","LILRB3 ","LYN ","MCOLN2 ","P2RX7 ","PDCD1 ","PDCD1LG2 ","RELB ","RIPK2 ","RNF19B ","RSAD2 ","SERPING1 ","SIT1 ","SLAMF1 ","SLAMF6 ","SLAMF7 ","SLC11A1 ","TAP1 ","TAP2 ","TBX21 ","TLR8 ","TNFRSF11A ","TNFRSF21 ","TNFSF13B ","TNFSF18 ","ZC3H12A ","CAMK2D ","CIITA ","GBP1 ","GBP2 ","MT2A ","NLRC5 ","NMI ","OAS2 ","PARP14 ","PML ","SOCS1 ","STAT1 ","TRIM22 ","TRIM31 ","VCAM1 ","IFI27 ","IFI35 ","IFIT2 ","IFIT3 ","IFITM1 ","IFITM2 ","IFITM3 ","ISG20 ","PSMB8 ","STAT2 ","XAF1 ","ZBP1 ","TAPBP "],"color":["#440154FF","#31688EFF","#35B779FF","#FDE725FF","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue","steelblue"],"pad":15,"thickness":20,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3],"target":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,4,93,94,95,96,36,37,38,43,44,45,46,47,48,49,50,51,52,53,54,59,60,62,97,98,99,100,101,102,103,104,105,106,107,96,36,37,38,51,52,53,108,109,110,111,112,113,114,59,60,115,98,100,116,77,104,117,118,119,4,30,36,37,38,51,52,53,84,85,120],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://federicomarini.github.io" class="external-link">Federico Marini</a>, Annekathrin Ludt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

